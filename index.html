<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscriptions GE - CPT. Dr Shili Mohamed</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        :root { --primary: #0f172a; --accent: #2563eb; --bg: #f8fafc; --shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); padding: 20px; color: #1e293b; }
        .container { max-width: 1000px; margin: 0 auto; }
        
        /* Menu */
        #menu { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 80vh; }
        .cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; width: 100%; margin-top: 30px; }
        .card { background: white; padding: 40px; border-radius: 20px; box-shadow: var(--shadow); cursor: pointer; text-align: center; transition: 0.3s; border: 2px solid transparent; }
        .card:hover { transform: translateY(-5px); border-color: var(--accent); }
        .card i { font-size: 3rem; color: var(--accent); margin-bottom: 15px; }

        /* Interface */
        #app { display: none; }
        header { background: #0f172a; color: white; padding: 30px; border-radius: 20px; text-align: center; margin-bottom: 20px; position: relative; }
        .btn-back { position: absolute; left: 20px; top: 20px; background: #334155; color: white; border: none; padding: 8px 15px; border-radius: 8px; cursor: pointer; }

        .form-section { background: white; border-radius: 15px; padding: 25px; box-shadow: var(--shadow); margin-bottom: 20px; }
        .inputs { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px; }
        input, select { width: 100%; padding: 12px; border: 1px solid #cbd5e1; border-radius: 8px; font-family: inherit; }
        .btn-submit { width: 100%; background: var(--accent); color: white; border: none; padding: 15px; border-radius: 10px; font-weight: 700; cursor: pointer; font-size: 1rem; }

        /* Tableau */
        .table-wrap { background: white; border-radius: 15px; overflow: hidden; box-shadow: var(--shadow); }
        table { width: 100%; border-collapse: collapse; }
        th { background: #f1f5f9; padding: 15px; text-align: left; font-size: 0.8rem; text-transform: uppercase; }
        td { padding: 15px; border-top: 1px solid #f1f5f9; vertical-align: top; }
        .txt-desc { white-space: pre-line; font-size: 0.85rem; color: #64748b; margin-top: 5px; display: block; }
        .badge { padding: 5px 10px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; }
        .free { background: #dcfce7; color: #166534; }
        .busy { background: #fee2e2; color: #991b1b; }
    </style>
</head>
<body>

<div class="container">
    <div id="menu">
        <h1 style="font-weight: 800;">Guerre Électronique - Inscriptions Mini Projet</h1>
        <div class="cards">
            <div class="card" onclick="openApp('106')">
                <i class="fas fa-book"></i>
                <h2>MPSM-S2 106</h2>
                <p>TD :Propositions de projets</p>
            </div>
            <div class="card" onclick="openApp('107')">
                <i class="fas fa-microchip"></i>
                <h2>MPSM-S2 107</h2>
                <p>TD :Propositions de projets</p>
            </div>
        </div>
    </div>

    <div id="app">
        <header>
            <button class="btn-back" onclick="location.reload()">Retour</button>
            <h1 id="titleSec">Section</h1>
            <p>Enseignant : CPT. Dr Shili Mohamed</p>
        </header>

        <div class="form-section">
            <div class="inputs">
                <input type="text" id="et1" placeholder="Étudiant 1 (Responsable)">
                <input type="text" id="et2" placeholder="Étudiant 2">
                <input type="text" id="et3" placeholder="Étudiant 3">
            </div>
            <select id="projSelect" style="margin-bottom: 15px;"></select>
            <button class="btn-submit" id="mainBtn" onclick="envoyer()">Confirmer l'inscription</button>
        </div>

        <div class="table-wrap">
            <table>
                <thead>
                    <tr><th>Sujet & Description</th><th>Groupe</th><th>État</th></tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
const URL_DB = "https://sheetdb.io/api/v1/rxeaqodo44ckd";

const LISTE_106 = [
    { id: "106-1", t: "1. Analyse des techniques de brouillage des communications radio", d: "Étude des types de brouillage (bruit, barrage, balayage, réactif).\nImpact sur les communications militaires.\nMéthodes de protection et contre-mesures (ECCM)." },
    { id: "106-2", t: "2. Guerre électronique et radars : principes et contre-mesures", d: "Fonctionnement des radars militaires.\nTechniques de brouillage radar.\nLeurre, brouillage actif/passif et furtivité." },
    { id: "106-3", t: "3. Détection et interception des signaux électromagnétiques (SIGINT)", d: "Principes de l’écoute électronique (ELINT / COMINT).\nMéthodes de localisation des émetteurs.\nApplications militaires modernes." },
    { id: "106-4", t: "4. Techniques de protection des communications militaires", d: "Chiffrement, étalement de spectre (FHSS, DSSS).\nSauts de fréquence.\nRésistance aux attaques de guerre électronique." },
    { id: "106-5", t: "5. Guerre électronique dans les conflits modernes", d: "Étude de cas (sans détails sensibles).\nRôle stratégique de la guerre électronique.\nÉvolution des doctrines militaires." },
    { id: "106-6", t: "6. Drones et guerre électronique", d: "Vulnérabilités électromagnétiques des drones.\nTechniques de brouillage GPS.\nMoyens de protection et de résilience." },
    { id: "106-7", t: "7. Guerre électronique et GPS", d: "Principes du GPS militaire.\nBrouillage (jamming) et usurpation (spoofing).\nContre-mesures et systèmes alternatifs de navigation." },
    { id: "106-8", t: "8. Rôle de l’intelligence artificielle dans la guerre électronique", d: "Détection automatique des signaux hostiles.\nClassification par apprentissage automatique.\nPerspectives futures (sans implémentation sensible)." },
    { id: "106-9", t: "9. Cyber-guerre et guerre électronique : complémentarité", d: "Différences et points de convergence.\nAttaques hybrides.\nImportance de la coordination cyber–EM." },
    { id: "106-10", t: "10. Guerre électronique et sécurité des réseaux sans fil", d: "Attaques sur les réseaux Wi-Fi et radios tactiques.\nInterférences intentionnelles.\nSolutions de protection." }
];

const LISTE_107 = [
    { id: "107-1", t: "Projet 1 : Étude et simulation du brouillage d’une liaison radio", d: "Analyse des principes fondamentaux du brouillage intentionnel des communications radio et simulation de son impact sur les performances d’une liaison (rapport signal sur bruit, taux d’erreur binaire)." },
    { id: "107-2", t: "Projet 2 : Identification et analyse des signaux radar", d: "Étude des caractéristiques temporelles et fréquentielles des signaux radar et mise en œuvre d’une méthode simple d’identification et de reconnaissance." },
    { id: "107-3", t: "Projet 3 : Étude du rôle de la guerre électronique dans la défense aérienne", d: "Analyse documentaire et simulation de scénarios où la GE permet la protection de zones aériennes stratégiques." },
    { id: "107-4", t: "Projet 4 : Techniques de protection électronique contre le brouillage", d: "Étude comparative des principales techniques de protection électronique, telles que le saut de fréquence et l’étalement de spectre, appliquées aux systèmes de communication." },
    { id: "107-5", t: "Projet 5 : Analyse des effets du brouillage GPS sur les systèmes de navigation", d: "Étude du fonctionnement du système GPS et analyse des conséquences du brouillage sur la précision et la fiabilité du positionnement." },
    { id: "107-6", t: "Projet 6 : Classification automatique des signaux électromagnétiques", d: "Extraction de paramètres caractéristiques des signaux et proposition d’une méthode simple de classification (signaux de communication, signaux radar, bruit)." },
    { id: "107-7", t: "Projet 7 : Conception fonctionnelle d’un système de guerre électronique", d: "Modélisation de l’architecture fonctionnelle d’un système de guerre électronique intégrant les phases de détection, d’analyse et de contre-mesures." },
    { id: "107-8", t: "Projet 8 : Analyse des brouillages numériques en communication Wi-Fi", d: "Identification et simulation de différents types de brouillage sur les réseaux Wi-Fi, avec mesure de l’impact sur le débit et la qualité de service." },
    { id: "107-9", t: "Projet 9 : Rôle stratégique de la guerre électronique dans les systèmes militaires modernes", d: "Analyse documentaire mettant en évidence l’importance stratégique de la guerre électronique dans les opérations militaires contemporaines." },
    { id: "107-10", t: "Projet 10 : Mesures de soutien électronique (ESM) pour la détection des menaces", d: "Étude des principes des mesures de soutien électronique (ESM) et application à la surveillance et à l’identification des émissions électromagnétiques." }
];

let currentSec = "";
let currentData = [];

function openApp(sec) {
    currentSec = sec;
    currentData = (sec === '106') ? LISTE_106 : LISTE_107;
    document.getElementById("menu").style.display = "none";
    document.getElementById("app").style.display = "block";
    document.getElementById("titleSec").innerText = "Projets MPSM-S2 " + sec;
    charger();
}

async function charger() {
    try {
        const r = await fetch(`${URL_DB}?t=${Date.now()}`);
        const db = await r.json();
        const sel = document.getElementById("projSelect");
        const body = document.getElementById("tableBody");
        
        sel.innerHTML = '<option value="">-- Choisir un projet --</option>';
        body.innerHTML = '';

        currentData.forEach(p => {
            const entry = db.find(x => String(x.id || x.ID) === String(p.id));
            const ok = !!entry;

            if(!ok) sel.innerHTML += `<option value="${p.id}">${p.t}</option>`;

            let noms = ok ? [entry.etudiant1||entry.Etudiant1, entry.etudiant2||entry.Etudiant2, entry.etudiant3||entry.Etudiant3].filter(n => n).join(" / ") : "---";

            body.innerHTML += `<tr>
                <td><strong>${p.t}</strong><span class="txt-desc">${p.d}</span></td>
                <td>${noms}</td>
                <td><span class="badge ${ok?'busy':'free'}">${ok?'Inscrit':'Disponible'}</span></td>
            </tr>`;
        });
    } catch(e) {}
}

async function envoyer() {
    const e1 = document.getElementById("et1").value;
    const pid = document.getElementById("projSelect").value;
    if(!e1 || !pid) return Swal.fire("Erreur", "Veuillez remplir le responsable et choisir un sujet.", "error");

    const conf = await Swal.fire({ title: "Confirmer ?", text: "L'inscription est définitive.", icon: "question", showCancelButton: true });
    if(!conf.isConfirmed) return;

    document.getElementById("mainBtn").disabled = true;
    Swal.showLoading();

    try {
        await fetch(URL_DB, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ data: [{
                id: pid, 
                classe: currentSec, 
                etudiant1: e1, 
                etudiant2: document.getElementById("et2").value, 
                etudiant3: document.getElementById("et3").value 
            }]})
        });
        await Swal.fire("Réussi", "Inscription validée !", "success");
        location.reload();
    } catch(e) {
        Swal.fire("Erreur", "Problème réseau", "error");
        document.getElementById("mainBtn").disabled = false;
    }
}
</script>
</body>
</html>